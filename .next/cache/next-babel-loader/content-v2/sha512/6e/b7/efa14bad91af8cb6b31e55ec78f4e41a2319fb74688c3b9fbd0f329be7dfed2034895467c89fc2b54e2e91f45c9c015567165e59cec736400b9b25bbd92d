{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/jeongyeon/Desktop/lecture_segmentation/web_dev/code/userstudy_t2/components/base.jsx\";\nimport _ from \"lodash\";\nimport Head from \"next/head\";\nimport React from \"react\";\nimport shortid from \"shortid\";\nimport styled, { css } from \"styled-components\";\nimport { createBreakpoint } from \"react-use\";\nimport { useAtom } from \"jotai\";\nimport { useEffect, useRef, useState } from \"react\";\nimport Content from \"./Content\";\nimport Controller from \"./Controller\";\nimport Video from \"./Video\";\nimport { darkModeAtom, durationAtom, frameHeightAtom, mobileModeAtom, withVideoAtom } from \"../atom\";\nimport useWindowOrientation from \"use-window-orientation\";\nconst useBreakpoint = createBreakpoint({\n  XL: 1280,\n  L: 768,\n  S: 350\n});\n\nconst ControllerLine = ({\n  content\n}) => {\n  const [duration] = useAtom(durationAtom);\n\n  const startTimes = _.map(content, \"end_time\");\n\n  if (!duration) {\n    return /*#__PURE__*/_jsxDEV(Loading, {\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 17\n      }, this)\n    }, shortid.generate(), false, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 13\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Line, {\n    children: startTimes.map(time => {\n      return /*#__PURE__*/_jsxDEV(LinePoint, {\n        value: time / duration * 100,\n        children: /*#__PURE__*/_jsxDEV(Circle, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 25\n        }, this)\n      }, shortid.generate(), false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 21\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 9\n  }, this);\n};\n\nconst Loading = styled.div.withConfig({\n  displayName: \"base__Loading\",\n  componentId: \"q9sefh-0\"\n})([\"> p{color:white;}z-index:200;background-color:black;position:fixed;min-width:100%;min-height:100%;display:\", \";flex:1;align-items:center;justify-content:center;\"], props => props.isLoading ? \"flex\" : \"none\");\nconst Circle = styled.div.withConfig({\n  displayName: \"base__Circle\",\n  componentId: \"q9sefh-1\"\n})([\"width:2px;height:10px;position:absolute;left:100%;z-index:999;background-color:#25252599;\"]);\nconst LinePoint = styled.div.withConfig({\n  displayName: \"base__LinePoint\",\n  componentId: \"q9sefh-2\"\n})([\"position:absolute;top:0;left:0;margin-top:5px;width:\", \"%;height:10px;\"], props => props.value);\nconst Line = styled.div.withConfig({\n  displayName: \"base__Line\",\n  componentId: \"q9sefh-3\"\n})([\"margin-top:5px;pointer-events:none;display:flex;width:100%;height:20px;position:absolute;z-index:200;overflow:hidden;top:0;> div:last-child{visibility:hidden;}\"]);\n\nconst modeSelector = ({\n  mobile,\n  dark\n}) => {\n  if (mobile === false && dark === false) {\n    return \"original\";\n  }\n\n  if (mobile === false && dark === true) {\n    return \"original_dark\";\n  }\n\n  if (mobile === true && dark === false) {\n    return \"restructure\";\n  }\n\n  if (mobile === true && dark === true) {\n    return \"restructure_dark\";\n  }\n};\n\nconst imageSelector = ({\n  location,\n  dark\n}) => {\n  if (location === \"top\" & dark === false) {\n    return \"top_img\";\n  }\n\n  if (location === \"top\" & dark === true) {\n    return \"top_img_dark\";\n  }\n\n  if (location === \"bottom\" & dark === false) {\n    return \"bottom_img\";\n  }\n\n  if (location === \"bottom\" & dark === true) {\n    return \"bottom_img_dark\";\n  }\n};\n\nconst Base = ({\n  input\n}) => {\n  const [dark] = useAtom(darkModeAtom);\n  const [mobile] = useAtom(mobileModeAtom);\n  const [height, setHeight] = useAtom(frameHeightAtom);\n  const {\n    0: content,\n    1: setContent\n  } = useState(input.content.original);\n  useEffect(() => {\n    reset();\n    setContent(input.content[modeSelector({\n      mobile,\n      dark\n    })]);\n  }, [dark, mobile]);\n  useEffect(() => {\n    setHeight(input.template.height);\n  }, []);\n  const [duration] = useAtom(durationAtom);\n  const {\n    0: key,\n    1: setKey\n  } = useState(shortid.generate());\n\n  const reset = () => {\n    setKey(() => shortid.generate());\n    videoComponentRef.current.initial();\n  };\n\n  const [withVideo] = useAtom(withVideoAtom);\n  const videoComponentRef = useRef();\n\n  const togglePlay = () => {\n    videoComponentRef.current.toggle();\n  };\n\n  const jump = percentPoint => {\n    videoComponentRef.current.jump(percentPoint);\n  };\n\n  const videoSource = input.sourcePath + input.video.source;\n  const frameInfo = {\n    sourcePath: input.sourcePath,\n    topBg: input.template[imageSelector({\n      location: \"top\",\n      dark\n    })],\n    bottomBg: input.template[imageSelector({\n      location: \"bottom\",\n      dark\n    })],\n    topHeight: input.template.top_padding / input.template.height * 100,\n    bottomHeight: input.template.bottom_padding / input.template.height * 100\n  };\n  const {\n    portrait\n  } = useWindowOrientation();\n  const breakpoint = useBreakpoint();\n  useEffect(() => {\n    reset();\n  }, [portrait]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"preconnect\",\n        href: \"https://fonts.googleapis.com\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"preconnect\",\n        href: \"https://fonts.gstatic.com\",\n        crossorigin: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }, this), input.template.fontUrl.map(url => {\n        return /*#__PURE__*/_jsxDEV(\"link\", {\n          href: url,\n          rel: \"stylesheet\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 28\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"apple-mobile-web-app-capable\",\n        content: \"yes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"apple-mobile-web-app-status-bar-style\",\n        content: \"black-translucent\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"viewport\",\n        content: \"viewport-fit=cover, user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      className: \"node\",\n      isDark: dark,\n      children: [portrait && breakpoint === 'S' && /*#__PURE__*/_jsxDEV(Block, {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\uAC00\\uB85C\\uC7A0\\uAE08\\uC744 \\uD574\\uC81C \\uD6C4 \\uD654\\uBA74\\uC744 \\uAC00\\uB85C\\uB85C \\uB193\\uC544\\uC8FC\\uC138\\uC694\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 53\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 46\n      }, this), /*#__PURE__*/_jsxDEV(Loading, {\n        isLoading: !duration,\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"loading..\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(InnerContainer, {\n        isFull: !withVideo,\n        disableControl: _.get(input, 'template.disableControl'),\n        children: [/*#__PURE__*/_jsxDEV(InnerContent, {\n          children: content.map((data, index) => {\n            return /*#__PURE__*/_jsxDEV(Content, {\n              data: data,\n              index: index,\n              sourcePath: input.sourcePath,\n              frameInfo: frameInfo,\n              isFull: !withVideo,\n              template: input.template,\n              disableControl: _.get(input, 'template.disableControl')\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 36\n            }, this);\n          })\n        }, key, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Video, {\n          src: videoSource,\n          content: content,\n          ref: videoComponentRef,\n          videoLocation: input.video.control\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ControllerContainer, {\n        children: [/*#__PURE__*/_jsxDEV(Controller, {\n          reset: reset,\n          togglePlay: togglePlay,\n          jump: jump,\n          disableControl: _.get(input, 'template.disableControl')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ControllerLine, {\n          content: content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\nconst Block = styled.div.withConfig({\n  displayName: \"base__Block\",\n  componentId: \"q9sefh-4\"\n})([\"color:white;position:fixed;width:100%;height:100%;background-color:black;z-index:3000;display:flex;justify-content:center;align-items:center;\"]);\nconst ControllerContainer = styled.div.withConfig({\n  displayName: \"base__ControllerContainer\",\n  componentId: \"q9sefh-5\"\n})([\"width:100%;position:relative;background-color:black;\"]);\nconst InnerContainer = styled.div.attrs({\n  className: \"frame\"\n}).withConfig({\n  displayName: \"base__InnerContainer\",\n  componentId: \"q9sefh-6\"\n})([\"flex:1;display:flex;align-items:stretch;padding-right:200px;position:relative;background-color:transparent;\", \";\"], props => props.isFull && css([\"padding-right:0;\"]));\nconst Container = styled.div.withConfig({\n  displayName: \"base__Container\",\n  componentId: \"q9sefh-7\"\n})([\"display:flex;flex-direction:column;height:100vh;max-height:100vh;width:100vw;max-width:100vw;overflow:hidden;box-sizing:border-box;align-items:stretch;position:relative;background-color:\", \";@supports (-webkit-touch-callout:none){height:-webkit-fill-available;}\"], props => props.isDark ? `rgb(47, 48, 48)` : \"white\");\nconst InnerContent = styled.div.withConfig({\n  displayName: \"base__InnerContent\",\n  componentId: \"q9sefh-8\"\n})([\"flex:1;display:flex;align-items:stretch;position:relative;\"]);\nexport default Base;","map":{"version":3,"sources":["/Users/jeongyeon/Desktop/lecture_segmentation/web_dev/code/userstudy_t2/components/base.jsx"],"names":["_","Head","React","shortid","styled","css","createBreakpoint","useAtom","useEffect","useRef","useState","Content","Controller","Video","darkModeAtom","durationAtom","frameHeightAtom","mobileModeAtom","withVideoAtom","useWindowOrientation","useBreakpoint","XL","L","S","ControllerLine","content","duration","startTimes","map","generate","time","Loading","div","props","isLoading","Circle","LinePoint","value","Line","modeSelector","mobile","dark","imageSelector","location","Base","input","height","setHeight","setContent","original","reset","template","key","setKey","videoComponentRef","current","initial","withVideo","togglePlay","toggle","jump","percentPoint","videoSource","sourcePath","video","source","frameInfo","topBg","bottomBg","topHeight","top_padding","bottomHeight","bottom_padding","portrait","breakpoint","fontUrl","url","get","data","index","control","Block","ControllerContainer","InnerContainer","attrs","className","isFull","Container","isDark","InnerContent"],"mappings":"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","sourcesContent":["import _ from \"lodash\";\nimport Head from \"next/head\";\nimport React from \"react\";\nimport shortid from \"shortid\";\nimport styled, { css } from \"styled-components\";\nimport { createBreakpoint } from \"react-use\";\nimport { useAtom } from \"jotai\";\nimport { useEffect, useRef, useState } from \"react\";\n\nimport Content from \"./Content\";\nimport Controller from \"./Controller\";\nimport Video from \"./Video\";\nimport { darkModeAtom, durationAtom, frameHeightAtom, mobileModeAtom, withVideoAtom } from \"../atom\";\nimport useWindowOrientation from \"use-window-orientation\";\n\nconst useBreakpoint = createBreakpoint({ XL: 1280, L: 768, S: 350 });\n\nconst ControllerLine = ({ content }) => {\n    const [duration] = useAtom(durationAtom);\n\n    const startTimes = _.map(content, \"end_time\");\n    if (!duration) {\n        return (\n            <Loading key={shortid.generate()}>\n                <p>loading...</p>\n            </Loading>\n        );\n    }\n\n    return (\n        <Line>\n            {startTimes.map((time) => {\n                return (\n                    <LinePoint value={(time / duration) * 100} key={shortid.generate()}>\n                        <Circle />\n                    </LinePoint>\n                );\n            })}\n        </Line>\n    );\n};\nconst Loading = styled.div`\n    > p {\n        color: white;\n    }\n\n    z-index: 200;\n    background-color: black;\n    position: fixed;\n    min-width: 100%;\n    min-height: 100%;\n    display: ${(props) => (props.isLoading ? \"flex\" : \"none\")};\n    flex: 1;\n    align-items: center;\n    justify-content: center;\n`;\n\nconst Circle = styled.div`\n    width: 2px;\n    height: 10px;\n    position: absolute;\n    left: 100%;\n    z-index: 999;\n    /* border-radius: 45%; */\n    background-color:#25252599;\n`;\nconst LinePoint = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    margin-top: 5px;\n    width: ${(props) => props.value}%;\n    height: 10px;\n`;\nconst Line = styled.div`\n    margin-top: 5px;\n    pointer-events: none;\n    display: flex;\n    width: 100%;\n    height: 20px;\n    position: absolute;\n    z-index: 200;\n    overflow: hidden;\n    top: 0;\n    > div:last-child {\n        visibility: hidden;\n    }\n`;\n\nconst modeSelector = ({ mobile, dark }) => {\n    if (mobile === false && dark === false) {\n        return \"original\";\n    }\n\n    if (mobile === false && dark === true) {\n        return \"original_dark\";\n    }\n\n    if (mobile === true && dark === false) {\n        return \"restructure\";\n    }\n\n    if (mobile === true && dark === true) {\n        return \"restructure_dark\";\n    }\n};\nconst imageSelector = ({ location, dark }) => {\n    if ((location === \"top\") & (dark === false)) {\n        return \"top_img\";\n    }\n    if ((location === \"top\") & (dark === true)) {\n        return \"top_img_dark\";\n    }\n\n    if ((location === \"bottom\") & (dark === false)) {\n        return \"bottom_img\";\n    }\n    if ((location === \"bottom\") & (dark === true)) {\n        return \"bottom_img_dark\";\n    }\n};\n\nconst Base = ({input}) => {\n    const [dark] = useAtom(darkModeAtom);\n    const [mobile] = useAtom(mobileModeAtom);\n    const [height, setHeight] = useAtom(frameHeightAtom);\n    const [content, setContent] = useState(input.content.original);\n    useEffect(() => {\n        reset();\n        setContent(input.content[modeSelector({ mobile, dark })]);\n    }, [dark, mobile]);\n    useEffect(() => {\n        setHeight(input.template.height);\n    }, []);\n    const [duration] = useAtom(durationAtom);\n\n    const [key, setKey] = useState(shortid.generate());\n    const reset = () => {\n        setKey(() => shortid.generate());\n        videoComponentRef.current.initial()\n    };\n\n    const [withVideo] = useAtom(withVideoAtom);\n    const videoComponentRef = useRef();\n    const togglePlay = () => {\n        videoComponentRef.current.toggle();\n    };\n\n    const jump = (percentPoint) => {\n        videoComponentRef.current.jump(percentPoint);\n    };\n    const videoSource = input.sourcePath + input.video.source;\n\n    const frameInfo = {\n        sourcePath: input.sourcePath,\n        topBg: input.template[imageSelector({ location: \"top\", dark })],\n        bottomBg: input.template[imageSelector({ location: \"bottom\", dark })],\n        topHeight: (input.template.top_padding / input.template.height) * 100,\n        bottomHeight: (input.template.bottom_padding / input.template.height) * 100,\n    };\n    const {portrait} = useWindowOrientation();\n    const breakpoint = useBreakpoint();\n    useEffect(()=> {\n        reset()\n\n    }, [portrait])\n\n    return (\n        <>\n            <Head>\n                <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n                <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin />\n                {input.template.fontUrl.map((url) => {\n                    return <link href={url} rel=\"stylesheet\" />;\n                })}\n                <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n                <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black-translucent\" />\n                <meta name=\"viewport\" content=\"viewport-fit=cover, user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1\" />\n            </Head>\n            <Container className=\"node\" isDark={dark}>\n                {portrait&&breakpoint==='S'&&<Block><p>가로잠금을 해제 후 화면을 가로로 놓아주세요</p></Block>}\n                <Loading isLoading={!duration}>\n                    <p>loading..</p>\n                </Loading>\n                <InnerContainer isFull={!withVideo} disableControl={_.get(input, 'template.disableControl')}>\n                    <InnerContent key={key}>\n                        {content.map((data, index) => {\n                            return <Content key={index} data={data} index={index} sourcePath={input.sourcePath} frameInfo={frameInfo} isFull={!withVideo} template={input.template} disableControl={_.get(input, 'template.disableControl')}/>;\n                        })}\n                    </InnerContent>\n                    <Video src={videoSource} content={content} ref={videoComponentRef} videoLocation={input.video.control} />\n                </InnerContainer>\n                <ControllerContainer>\n                    <Controller reset={reset} togglePlay={togglePlay} jump={jump} disableControl={_.get(input, 'template.disableControl')}/>\n                    <ControllerLine content={content} />\n                </ControllerContainer>\n            </Container>\n        </>\n    );\n};\n\nconst Block = styled.div`\n    color: white;\n    position:fixed;\n    width: 100%;\n    height: 100%;\n    background-color: black;\n    z-index: 3000;\n    display: flex;\n    justify-content: center;\n    align-items:center;\n`\nconst ControllerContainer = styled.div`\n    width: 100%;\n    position: relative;\n    background-color: black;\n`;\nconst InnerContainer = styled.div.attrs({ className: \"frame\" })`\n    flex: 1;\n    display: flex;\n    align-items: stretch;\n    padding-right: 200px;\n    position: relative;\n    background-color:transparent;\n    ${(props) =>\n        props.isFull &&\n        css`\n            padding-right: 0;\n        `};\n`;\nconst Container = styled.div`\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n    max-height: 100vh;\n    width: 100vw;\n    max-width: 100vw;\n    overflow: hidden;\n    box-sizing: border-box;\n    align-items: stretch;\n    position: relative;\n    background-color: ${(props) => (props.isDark ? `rgb(47, 48, 48)` : \"white\")};\n    @supports (-webkit-touch-callout: none) {\n        height: -webkit-fill-available;\n    }\n`;\n\nconst InnerContent = styled.div`\n    flex: 1;\n    display: flex;\n    align-items: stretch;\n    position: relative;\n`;\nexport default Base;\n"]},"metadata":{},"sourceType":"module"}